<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">
<html>
  <head>
    <title>ExecutionModel</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="./static/css/blueprint/screen.css" type="text/css" media="screen, projection">
    <link rel="stylesheet" href="./static/css/blueprint/print.css" type="text/css" media="print">
    <!--[if lt IE 8]>
      <link rel="stylesheet" href="./static/css/blueprint/ie.css" type="text/css" media="screen, projection">
    <![endif]-->
    <link rel="stylesheet" href="./static/css/pygments/syntax.css" type="text/css">
    <link rel="stylesheet" href="./static/css/layout.css" type="text/css">
    <link rel="stylesheet" href="./static/css/colors.css" type="text/css">
    <script type="text/javascript" src="./static/js/graph.js"></script>
  </head>
  <body>
    <div class="container noshowgrid">
      <div class="span-20 prepend-2 append-2">
        <h1>ExecutionModel</h1>
        <div class="figure">
<img src="./static/images/stage-pre-code-gen.png" alt="Pre code generation." /><p class="caption">Pre code generation.</p>
</div>
<p>At this point we have a parser (<a href="StageParsing.html" title="StageParsing">StageParsing</a>) that transforms the con source code to a parse tree. Before we can transform the parse tree to C code, we need to understand the execution model of the source program. We need to figure out how to run con programs in C. This is probably the most difficult part in writing this compiler.</p>
<p>Let's look at an example:</p>
<pre><code>let fac = \(n, k) -&gt;
    facAccumulate n 1 k

let facAccumulate = \(n, result, k) -&gt;
    isZero n
        (\() -&gt; k result)
        (\() -&gt;
            minus n 1 \(newN) -&gt;
            times n result \(newResult) -&gt;
            facAccumulate newN newResult k)</code></pre>
<p>Let's try to run this function with n = 3:</p>
<pre><code>fac 3 k             --&gt;
facAccumulate 3 1 k --&gt;
facAccumulate 2 3 k --&gt;
facAccumulate 1 6 k --&gt;
facAccumulate 0 6 k --&gt;
k 6</code></pre>
<p><code>facAccumulate</code> is obviously called multiple times</p>
<ul>
<li>environment model</li>
</ul>
<h2 id="continue">Continue</h2>
<p><a href="RuntimeSupport.html" title="RuntimeSupport">RuntimeSupport</a> or <a href="CodeGeneration.html" title="CodeGeneration">CodeGeneration</a></p>
        <hr />
        <svg xmlns="http://www.w3.org/2000/svg" id="canvas"></svg>
        <script type="text/javascript">
            var colors = function (level) {
                if (level == 1) {
                    return {
                        color: "#fcaf3e",
                        stroke: "#ab7423"
                    };
                } else if (level == 2) {
                    return {
                        color: "#fce94f",
                        stroke: "#c4a000"
                    };
                } else if (level == 3) {
                    return {
                        color: "#8ae234",
                        stroke: "#425d26"
                    };
                }
            };
            var goToPageFn = function(page) {
                return function() {
                    location.href = page + ".html";
                };
            };
            var g = new Graph("canvas", 800, 400);
            g.repulsion = g.repulsion / 2;
            //g.spring_length = 8;
            g.createVertex("ExecutionModel", colors(1), goToPageFn("ExecutionModel"));g.createVertex("CodeGeneration", colors(2), goToPageFn("CodeGeneration"));g.createVertex("RuntimeSupport", colors(2), goToPageFn("RuntimeSupport"));g.createVertex("StageParsing", colors(2), goToPageFn("StageParsing"));g.createVertex("AssembleHex", colors(3), goToPageFn("AssembleHex"));g.createVertex("CodeGenerationFramework", colors(3), goToPageFn("CodeGenerationFramework"));g.createVertex("ConLanguage", colors(3), goToPageFn("ConLanguage"));g.createVertex("ConcOverview", colors(3), goToPageFn("ConcOverview"));g.createVertex("ParseTree", colors(3), goToPageFn("ParseTree"));g.createVertex("ParsecIntroduction", colors(3), goToPageFn("ParsecIntroduction"));
            g.createEdge("ExecutionModel", "StageParsing");g.createEdge("ExecutionModel", "RuntimeSupport");g.createEdge("ExecutionModel", "CodeGeneration");g.createEdge("CodeGeneration", "RuntimeSupport");g.createEdge("CodeGeneration", "CodeGenerationFramework");g.createEdge("CodeGeneration", "AssembleHex");g.createEdge("RuntimeSupport", "ExecutionModel");g.createEdge("StageParsing", "ParseTree");g.createEdge("StageParsing", "ParsecIntroduction");g.createEdge("StageParsing", "ConLanguage");g.createEdge("StageParsing", "ExecutionModel");g.createEdge("AssembleHex", "RuntimeSupport");g.createEdge("AssembleHex", "CodeGeneration");g.createEdge("CodeGenerationFramework", "CodeGeneration");g.createEdge("ConcOverview", "StageParsing");
            g.go();
        </script>
        <hr />
        <p>
        <center>
        1. <a href="HomePage.html">HomePage</a>
        |
        2. <a href="StageParsing.html">StageParsing</a>
        |
        3. <a href="RuntimeSupport.html">RuntimeSupport</a>
        |
        4. <a href="CodeGeneration.html">CodeGeneration</a>
        |
        5. <a href="AssembleHex.html">AssembleHex</a>
        </center>
        </p>
        <hr />
      </div>
    </div>
  </body>
</html>